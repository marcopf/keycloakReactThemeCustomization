"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.statefulObservableToStatefulEvt = void 0;
var evt_1 = require("evt");
function statefulObservableToStatefulEvt(params) {
    var statefulObservable = params.statefulObservable, _a = params.ctx, ctx = _a === void 0 ? evt_1.Evt.newCtx() : _a;
    var evt = evt_1.Evt.create(statefulObservable.current);
    var doSkip = false;
    evt.attach(ctx, function (data) {
        doSkip = true;
        statefulObservable.current = data;
        doSkip = false;
    });
    var unsubscribe = statefulObservable.subscribe(function (data) {
        if (doSkip) {
            return;
        }
        evt.state = data;
    }).unsubscribe;
    ctx.evtDoneOrAborted.attach(function () { return unsubscribe(); });
    return evt;
}
exports.statefulObservableToStatefulEvt = statefulObservableToStatefulEvt;
//# sourceMappingURL=statefulObservableToStatefulEvt.js.map
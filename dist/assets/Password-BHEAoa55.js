import{j as e,r as m}from"./index-Bk5ipnyi.js";import{d as p}from"./index-C5IxwAqk.js";const j="account-console",N="http://localhost:8080/realms/master/protocol/openid-connect/auth",w="http://localhost:8080/realms/master/protocol/openid-connect/token",g="http://localhost:8080/realms/master/account/",v="openid",u="http://localhost:8080/realms/master/account/credentials/",y="http://localhost:8080/realms/master/protocol/openid-connect/auth?client_id=account-console&redirect_uri=http://localhost:8080/realms/master/account&state=d7d1a0a3-fb42-4a4c-8d5d-9311c20a6388&response_mode=query&code_challenge=XSRahxpQ59S7SzBGlRXc41wXKTT2_e-EJ_GPcGMCi2E&http://localhost:8080/realms/master/protocol/openid-connect/auth?client_id=account-console&response_type=code&scope=openid&nonce=207f4110-eb53-431c-ad70-497f50800d2c&kc_action=CONFIGURE_TOTP&code_challenge_method=S256",C={clientId:j,authorizationEndpoint:N,tokenEndpoint:w,redirectUri:g,scope:v,onRefreshTokenExpire:t=>window.confirm("Session expired. Refresh page to continue using the site?")&&t.login()};async function b(t){const s=await fetch(u,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t}});let n={};try{s.ok&&(n=await s.json())}catch(r){console.log(r)}return n}function i(t){return(t<10?"0":"")+t}function E(t){var s=new Date(t),n=s.getFullYear(),r=s.getMonth()+1,o=s.getDate(),a=s.getHours(),c=s.getMinutes(),d=s.getSeconds();return n+"-"+i(r)+"-"+i(o)+" "+i(a)+":"+i(c)+":"+i(d)}function T(){const{token:t}=m.useContext(p.AuthContext),[s,n]=m.useState([]);async function r(o){if(console.log(t),!confirm("vuoi eleminare?"))return;(await fetch(u+o.target.getAttribute("id"),{method:"DELETE",headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"}})).ok?window.location.reload():alert("Errore!")}return m.useEffect(()=>{(async()=>{try{const a=await b(t),c=a[1].userCredentialMetadatas;c&&a[1]&&n(c)}catch(a){console.error("Error fetching user info:",a)}})()},[t]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row my-5",children:[e.jsx("div",{className:"col-8",children:e.jsx("h1",{children:"Otp Section"})}),e.jsx("div",{className:"col-4 d-flex justify-content-end align-items-center",children:e.jsx("a",{href:y,children:"Configure new Otp"})})]}),s.length==0?e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-6 d-flex justify-content-center",children:e.jsx("span",{className:"text-danger",children:"No Configuration Found!"})})}):e.jsx(e.Fragment,{}),s.map(o=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mt-4 p-3 row align-items-center",children:[e.jsxs("div",{className:"col-4 d-flex flex-column",children:[e.jsx("strong",{className:"me-3",children:"Otp Label: "}),o.credential.userLabel]}),e.jsxs("div",{className:"col-4 d-flex flex-column",children:[e.jsx("strong",{className:"me-3",children:"Creation Date: "}),E(o.credential.createdDate)]}),e.jsx("div",{className:"col-4 d-flex justify-content-end",children:e.jsx("button",{id:o.credential.id,className:"btn btn-danger",onClick:r,children:"Remove"})})]})}))]})}function _(){return e.jsx(e.Fragment,{children:e.jsx(p.AuthProvider,{authConfig:C,children:e.jsx(T,{})})})}function I(t){let s=t;console.log(t,s);const{kcContext:n,i18n:r,doUseDefaultCss:o,Template:a,classes:c}=s,{url:d,password:h,account:x,stateChecker:f}=n,{msg:l}=r;return e.jsxs(a,{kcContext:n,i18n:r,doUseDefaultCss:o,classes:c,active:"password",children:[e.jsxs("div",{className:"row d-flex align-items-center",children:[e.jsx("div",{className:"col-md-8",children:e.jsx("h2",{children:l("changePasswordHtmlTitle")})}),e.jsx("div",{className:"col-md-4 subtitle",children:e.jsx("span",{className:"subtitle",children:l("allFieldsRequired")})})]}),e.jsxs("form",{action:d.passwordUrl,className:"form-horizontal mt-3",method:"post",children:[e.jsx("input",{type:"text",id:"username",name:"username",value:x.username??"",autoComplete:"username",readOnly:!0,style:{display:"none"}}),h.passwordSet&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"active control-label",htmlFor:"password",children:l("password")}),e.jsx("input",{type:"password",className:"form-control",id:"password",name:"password",autoComplete:"current-password"})]}),e.jsx("input",{type:"hidden",id:"stateChecker",name:"stateChecker",value:f}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"active control-label",htmlFor:"password-new",children:l("passwordNew")}),e.jsx("input",{type:"password",className:"form-control",id:"password-new",name:"password-new",autoComplete:"new-password","aria-describedby":"formGroupExampleInputWithHelpDescription"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"active control-label",htmlFor:"password-confirm",children:l("passwordConfirm")}),e.jsx("input",{type:"password",className:"form-control",id:"password-confirm",name:"password-confirm",autoComplete:"new-password"})]}),e.jsx("div",{className:"form-group",children:e.jsx("div",{id:"kc-form-buttons",className:"submit",children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"submit",className:"btn btn-primary",name:"submitAction",value:"Save",children:l("doSave")})})})})]}),e.jsx(_,{})]})}export{I as default};
//# sourceMappingURL=Password-BHEAoa55.js.map

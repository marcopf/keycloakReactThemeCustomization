import{b as p,j as e}from"./index-B8-9oSLq.js";import{d as x}from"./index-DAy2jz70.js";import{s as u}from"./KcApp-nBJZbCcM.js";import"./useGetClassName-Bjf0te0P.js";function h(t){return(t<10?"0":"")+t}function f(t){var s=new Date(t),o=s.getFullYear(),m=s.getMonth()+1,r=s.getDate(),d=s.getHours(),i=s.getMinutes(),n=s.getSeconds();return o+"-"+h(m)+"-"+h(r)+" "+h(d)+":"+h(i)+":"+h(n)}function j(t){const{token:s}=p.useContext(x.AuthContext),[o,m]=p.useState([]);let r=t.msg;async function d(n){const a=await fetch(t.props.kcContext.properties.OTP_INFO_ENDPOINT,{method:"GET",credentials:"include",headers:{"Content-Type":"application/json",Authorization:"Bearer "+n}});let l={};try{a.ok&&(l=await a.json())}catch(c){console.log(c)}return l}async function i(n){let a=n.target;if(a.tagName=="SPAN"&&(a=a.parentNode),!confirm("vuoi eleminare?"))return;(await fetch(t.props.kcContext.properties.OTP_INFO_ENDPOINT+a.getAttribute("id"),{method:"DELETE",headers:{Authorization:"Bearer "+s,"Content-Type":"application/json"}})).ok?window.location.reload():alert("Errore!")}return p.useEffect(()=>{(async()=>{try{const a=await d(s),l=a[1].userCredentialMetadatas;l&&a[1]&&m(l)}catch(a){console.error("Error fetching user info:",a)}})()},[s]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"row my-5",children:[e.jsx("div",{className:"col-8",children:e.jsx("h1",{children:r("configureAuthenticators")})}),e.jsx("div",{className:"col-4 d-flex justify-content-end align-items-center",children:e.jsx("a",{href:t.props.kcContext.properties.NEW_OTP_CONFIGURATION,children:r("authenticatorSubTitle")})})]}),o.length==0?e.jsx("div",{className:"row justify-content-center",children:e.jsx("div",{className:"col-6 d-flex justify-content-center",children:e.jsx("span",{className:"text-danger",children:r("notHaveAnyResource")})})}):e.jsx(e.Fragment,{}),o.map(n=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"mt-4 p-3 row align-items-center",children:[e.jsxs("div",{className:"col-4 d-flex flex-column",children:[e.jsxs("strong",{className:"me-3",children:[r("totpDeviceName"),": "]}),n.credential.userLabel]}),e.jsxs("div",{className:"col-4 d-flex flex-column",children:[e.jsxs("strong",{className:"me-3",children:[r("date"),": "]}),f(n.credential.createdDate)]}),e.jsx("div",{className:"col-4 d-flex justify-content-end",children:e.jsx("button",{id:n.credential.id,className:"btn btn-danger",onClick:i,children:r("doRemove")})})]})}))]})}function w(t){const[s,o]=p.useState({}),[m,r]=p.useState(!1);if(p.useEffect(()=>{(async()=>{const i=await fetch(t.props.kcContext.properties.WELL_KNOWN_API);if(i.ok){let n=await i.json();o(n),r(!0)}})()},[]),m){const d={clientId:"account-console",authorizationEndpoint:s.authorization_endpoint,tokenEndpoint:s.token_endpoint,redirectUri:s.issuer+"/account",scope:"openid",onRefreshTokenExpire:i=>window.confirm("Session expired. Refresh page to continue using the site?")&&i.login()};return e.jsx(e.Fragment,{children:e.jsx(x.AuthProvider,{authConfig:d,children:e.jsx(j,{msg:t.msg,props:t.props})})})}return e.jsx(e.Fragment,{})}function y(t){const{kcContext:s,i18n:o,doUseDefaultCss:m,Template:r,classes:d}=t,{url:i,password:n,account:a,stateChecker:l}=s,{msg:c}=o;return e.jsxs(r,{kcContext:s,i18n:o,doUseDefaultCss:m,classes:d,active:"password",children:[e.jsxs("div",{className:"row d-flex align-items-center",children:[e.jsx("div",{className:"col-md-8",children:e.jsx("h2",{children:c("changePasswordHtmlTitle")})}),e.jsx("div",{className:"col-md-4 subtitle",children:e.jsxs("span",{className:"subtitle",children:["*",c("requiredFields")]})})]}),e.jsxs("form",{action:i.passwordUrl,className:"form-horizontal mt-3",method:"post",children:[e.jsx("input",{type:"text",id:"username",name:"username",value:a.username??"",autoComplete:"username",readOnly:!0,style:{display:"none"}}),n.passwordSet&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password",children:c("password")}),e.jsx("input",{type:"password","data-bs-input":!0,className:"form-control input-password",id:"password",name:"password","aria-labelledby":"infoPassword"}),e.jsxs("span",{className:"password-icon","aria-hidden":"true",children:[e.jsx("svg",{className:"password-icon-visible icon icon-sm",children:e.jsx("use",{href:u+"#it-password-visible"})}),e.jsx("svg",{className:"password-icon-invisible icon icon-sm d-none",children:e.jsx("use",{href:u+"#it-password-invisible"})})]})]}),e.jsx("input",{type:"hidden",id:"stateChecker",name:"stateChecker",value:l}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password-new",children:c("passwordNew")}),e.jsx("input",{type:"password","data-bs-input":!0,className:"form-control input-password",id:"password-new",name:"password-new","aria-labelledby":"infoPassword"}),e.jsxs("span",{className:"password-icon","aria-hidden":"true",children:[e.jsx("svg",{className:"password-icon-visible icon icon-sm",children:e.jsx("use",{href:u+"#it-password-visible"})}),e.jsx("svg",{className:"password-icon-invisible icon icon-sm d-none",children:e.jsx("use",{href:u+"#it-password-invisible"})})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"password-confirm",children:c("passwordConfirm")}),e.jsx("input",{type:"password","data-bs-input":!0,className:"form-control input-password",id:"password-confirm",name:"password-confirm","aria-labelledby":"infoPassword"}),e.jsxs("span",{className:"password-icon","aria-hidden":"true",children:[e.jsx("svg",{className:"password-icon-visible icon icon-sm",children:e.jsx("use",{href:u+"#it-password-visible"})}),e.jsx("svg",{className:"password-icon-invisible icon icon-sm d-none",children:e.jsx("use",{href:u+"#it-password-invisible"})})]})]}),e.jsx("div",{className:"form-group",children:e.jsx("div",{id:"kc-form-buttons",className:"submit",children:e.jsx("div",{className:"d-flex justify-content-end",children:e.jsx("button",{type:"submit",className:"btn btn-primary",name:"submitAction",value:"Save",children:c("doSave")})})})})]}),e.jsx(w,{msg:c,props:t})]})}export{y as default};
//# sourceMappingURL=Password-BmC2OBcG.js.map
